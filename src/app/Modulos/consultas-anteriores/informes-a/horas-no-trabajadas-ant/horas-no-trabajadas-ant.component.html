<section class="top animate__animated animate__fadeIn row ">
    <div class="col-md-1" *ngIf="!siAnio"></div>   
     <div class="col-md-3" *ngIf="!siAnio">
        <mdb-form-control>
            <mdb-select (valueChange)="changeYear($event)">
              <mdb-option *ngFor="let option of options" [value]="option.label">{{ option.label}}</mdb-option>
            </mdb-select>
            <label mdbLabel class="form-label">Seleccione el año a consultar</label>
          </mdb-form-control>
        
    </div>
    <div class="col-md-12" *ngIf="!pri && siAnio">
        <div class="container">
            <div class="alert alert-secondary alert-dismissible fade show text-center h5" role="alert">
              <strong>{{anio}}&nbsp; </strong> ¡Es el año seleccionado!.
              <button (click)="closeAlert()"  type="button" class="btn-close" aria-label="Close"></button>
            </div>
          </div>
    </div>
    
    </section>

    <div class="row top" *ngIf="!pri && siAnio && !loading">
      <div class="col-md-2 top1">
          <button (click)="exportAsXLSX()" mdbBtn class="btn btn-success" mdbWavesEffect>
              <i class="fas fa-file-excel"></i>
          </button>
          &nbsp;
          <button (click)="print('v-pills-profile1')" mdbBtn class="btn btn-danger" mdbWavesEffect>
              <i class="far fa-file-pdf"></i>
          </button>
      </div>
  </div>
  
  
  <section class="top animate__animated animate__fadeIn" id="v-pills-profile" *ngIf="!pri && siAnio">
  
  
      <table class="table datatable-table table-sm"
      mdbTable
      mdbTableSort
      #table="mdbTable"
      #sort="mdbTableSort"
      [dataSource]="data"
      [sort]="sort">
  
      <thead class="grey lighten-1  text-white">
              <tr>
                  <th>SECCIONES</th>
                  <th>ID SEC. &nbsp;</th>
                  <th>ENERO</th>
                  <th>FEBRERO</th>
                  <th>MARZO</th>
                  <th>ABRIL</th>
                  <th>MAYO</th>
                  <th>JUNIO</th>
                  <th>JULIO</th>
                  <th>AGOSTO</th>
                  <th>SEPTIEMBRE</th>
                  <th>OCTUBRE</th>
                  <th>NOVIEMBRE</th>
                  <th>DICIEMBRE</th>
              </tr>
          </thead>
          <tbody *ngIf="!loading">
  
              <tr *ngFor="let item of table.data">
                  <td> {{item.seccion}} </td>
                  <td> {{item.idPuesto}} </td>
  
                  <td > {{item.enero1}} </td>
                  <td> {{item.febrero1}} </td>
                  <td> {{item.marzo1}} </td>
                  <td> {{item.abril1}} </td>
                  <td > {{item.mayo1}} </td>
                  <td> {{item.junio1}} </td>
                  <td> {{item.julio1}} </td>
                  <td> {{item.agosto1}} </td>
                  <td> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{item.septiembre1}} </td>
                  <td>&nbsp;&nbsp; {{item.octubre1}} </td>
                  <td >&nbsp;&nbsp;&nbsp; {{item.noviembre1}} </td>
                  <td >&nbsp;&nbsp;&nbsp; {{item.diciembre1}} </td>
              </tr>
  
              <br><br>
              <tr class="alert alert-warning ">
                  <td colspan="2"> TOTALS</td>
                  <td>{{totalEnero}}</td>
                  <td>{{totalF}}</td>
                  <td>{{totalM}}</td>
                  <td>{{totalA}}</td>
                  <td>{{totalMa}}</td>
                  <td>{{totalJu}}</td>
                  <td>{{totalJul}}</td>
                  <td>{{totalAgo}}</td>
                  <td>{{totalSep}}</td>
                  <td>{{totalOct}}</td>
                  <td>{{totalNo}}</td>
                  <td>{{totalDic}}</td>
                  <!-- <td>{{totalEnero}}</td> -->
  
              </tr>
          </tbody>
      </table>
      <ng-container *ngIf="loading">
          <div class="datatable-loader bg-light">
            <span class="datatable-loader-inner">
              <span class="datatable-progress bg-primary"></span>
            </span>
          </div>
          <p class="text-center text-muted my-4">Cargando resultados...</p>
        </ng-container>
      <hr>
  
  </section>
  
  
  
  <!-- Impresión -->
  <section  id="v-pills-profile1" *ngIf="pri && siAnio">
  
  
      <div class="col-md-12 alert alert-secondary  text-center">
          INFORME DE HORAS NO TRABAJADAS POR SECCIÓN {{anio}}
  
      </div>
  
      <table mdbTable hover="true">
          <thead>
              <tr class="grey lighten-1  text-white">
                  <th>SECCIONES</th>
                  <th>ID SEC. &nbsp;</th>
                  <th>ENERO</th>
                  <th>FEBRERO</th>
                  <th>MARZO</th>
                  <th>ABRIL</th>
                  <th>MAYO</th>
                  <th>JUNIO</th>
                  <th>JULIO</th>
                  <th>AGOSTO</th>
                  <th>SEPTIEMBRE</th>
                  <th>OCTUBRE</th>
                  <th>NOVIEMBRE</th>
                  <th>DICIEMBRE</th>
              </tr>
          </thead>
          <tbody>
  
              <tr *ngFor="let item of data">
                <td> {{item.seccion}} </td>
                  <td> {{item.idPuesto}} </td>
  
                  <td > {{item.enero1}} </td>
                  <td> {{item.febrero1}} </td>
                  <td> {{item.marzo1}} </td>
                  <td> {{item.abril1}} </td>
                  <td > {{item.mayo1}} </td>
                  <td> {{item.junio1}} </td>
                  <td> {{item.julio1}} </td>
                  <td> {{item.agosto1}} </td>
                  <td> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{item.septiembre1}} </td>
                  <td>&nbsp;&nbsp; {{item.octubre1}} </td>
                  <td >&nbsp;&nbsp;&nbsp; {{item.noviembre1}} </td>
                  <td >&nbsp;&nbsp;&nbsp; {{item.diciembre1}} </td>
  
              </tr>
  
              <br><br>
              <tr class="alert alert-warning ">
                  <td colspan="2"> TOTALS</td>
                  <td>{{totalEnero}}</td>
                  <td>{{totalF}}</td>
                  <td>{{totalM}}</td>
                  <td>{{totalA}}</td>
                  <td>{{totalMa}}</td>
                  <td>{{totalJu}}</td>
                  <td>{{totalJul}}</td>
                  <td>{{totalAgo}}</td>
                  <td>{{totalSep}}</td>
                  <td>{{totalOct}}</td>
                  <td>{{totalNo}}</td>
                  <td>{{totalDic}}</td>
                  <!-- <td>{{totalEnero}}</td> -->
              </tr>
          </tbody>
      </table>
      <hr>
  
  </section>
  